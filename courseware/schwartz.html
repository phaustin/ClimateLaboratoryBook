
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Schwartzchild Equation &#8212; Climate Laboratory Book</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="canonical" href="https://a301_web.eoas.ubc.ca/courseware/schwartz.html" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://a301_web.eoas.ubc.ca/courseware/schwartz.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="The Schwartzchild Equation" />
<meta property="og:description" content="The Schwartzchild Equation  Introduction  This is Stull equation 8.3, which is known formally as the the “Schwartzchild equation” for wavelengths in which therm" />


<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Climate Laboratory Book</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../home.html">
   The Climate Laboratory
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Course structure and Outline
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Front matter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../preamble.html">
   Preamble
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about.html">
   About this Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../who-for.html">
   Who is the book for?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../how-to.html">
   How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution.html">
   How to cite and reuse this material
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra_reading.html">
   Additional resources
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="models-budgets-fun.html">
   1. Climate models, the global energy budget, and Fun with Python
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="zero-dim-ebm.html">
   2. Modeling the global energy budget
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="analytical-efolding.html">
     2.10.1. Advanced topic: Analytical solution of the global Energy Balance Model
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="climate-system-models.html">
   3. The climate system and climate models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introducing-cesm.html">
   4. Introducing the Community Earth System Model (CESM)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="climlab-intro.html">
   5. Building simple climate models using climlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiation.html">
   6. A Brief Review of Radiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="elementary-greenhouse.html">
   7. Elementary greenhouse models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sympy-greenhouse.html">
   8. Advanced topic: Solving the two-layer grey gas model analytically with sympy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="grey-radiation-climlab.html">
   9. Grey radiation modeling with climlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiative-transfer.html">
   10. Modeling non-scattering radiative transfer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spectral-bands.html">
   11. Who needs spectral bands? We do. Some baby steps…
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radeq.html">
   12. Radiative Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rce.html">
   13. Radiative-Convective Equilibrium
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="sensitivity-feedback.html">
   14. Climate sensitivity and feedback
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-sensitivity-feedback.html">
     14.8.1. Advanced topic: Climate sensitivity and feedback
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transient-cesm.html">
   15. Examing the transient and equilibrium CO
   <span class="math notranslate nohighlight">
    \(_2\)
   </span>
   response in the CESM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transient-toy.html">
   16. Toy models of transient warming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clouds.html">
   17. Clouds and cloud feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="insolation.html">
   18. Insolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbital.html">
   19. Orbital variations, insolation, and the ice ages
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="heat-transport.html">
   20. Heat transport
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-heat-transport.html">
     20.7.1. Advanced topic: Heat transport decomposition
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="one-dim-ebm.html">
   21. The one-dimensional energy balance model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="seasonal-cycle.html">
   22. Modeling the seasonal cycle of surface temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cesm-atmospheric-dynamics.html">
   23. Atmospheric Dynamics in the CESM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-diffusion.html">
   24. A peek at numerical methods for diffusion models
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="albedo-snowball.html">
   25. Ice-albedo feedback and Snowball Earth in the EBM
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-albedo-feedback.html">
     25.9.1. Advanced topic: Ice albedo feedback in the EBM – test2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-snowball-earth.html">
     25.9.2. Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cesm-coupled-dynamics.html">
   26. Coupled Dynamics in the CESM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surface-energy-balance.html">
   27. The surface energy balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="land-ocean-contrast.html">
   28. Land-Ocean contrasts under climate change
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="water-water-everywhere.html">
   29. Water, water everywhere!
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about-assignments.html">
   About the assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-zero-dim-ebm.html">
   Assignment: Climate change in the zero-dimensional EBM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-cesm-control.html">
   Assignment: Global average budgets in the CESM pre-industrial control simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-cesm-control-hints.html">
   Additional hints and guidance for CESM budgets assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-simple-clouds.html">
   Assignment: Clouds in the Leaky Greenhouse Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-rcm-feedback.html">
   Assignment: Feedbacks in the Radiative-Convective Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-cesm-climate-change.html">
   Assignment: Climate change in the CESM simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-insolation-orbit.html">
   Assignment: Insolation and orbital parameters
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Extra notebooks
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="hydrostat.html">
   Hydrostatic balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hydrostatic_balance.html">
   Scale heights for typical atmospheric soundings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hydrostatic_balance.html#use-pd-dataframe-head-to-see-first-5-lines">
   Use pd.DataFrame.head to see first 5 lines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_layer_equilibrium.html">
   Radiative equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_lecture.html">
   What I wish I’d known about statistics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/courseware/schwartz.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kirchoff-s-law">
   Kirchoff’s Law
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-emission-to-beer-s-law">
   Adding emission to Beer’s law
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperature-changing-with-height">
   Temperature changing with height
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-to-stull-8-3">
     Getting to Stull 8.3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-to-stull-8-4">
     Getting to Stull 8.4
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-do-we-care">
   Why do we care?
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="the-schwartzchild-equation">
<span id="schwartz"></span><h1>The Schwartzchild Equation<a class="headerlink" href="#the-schwartzchild-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This is Stull equation 8.3, which is known formally as the the “Schwartzchild equation” for
wavelengths in which thermal emission, but not scattering, is occurring:</p>
<div class="math notranslate nohighlight" id="equation-stull1">
<span class="eqno">()<a class="headerlink" href="#equation-stull1" title="Permalink to this equation">¶</a></span>\[   \begin{gathered}
         L_\lambda = \underbrace{B_\lambda(T_{skin} ) \hat{t}_{tot}}_{\text{surface contribution}} + \underbrace{\sum_{j=1}^n e_{\lambda,j} B_\lambda(T_j) \hat{t}_{\lambda,j}}_{\text{atmospheric contribution}}
   \end{gathered}\]</div>
<p>If you go back to Stull Chapter 2 you can see that it involves:</p>
<ol class="arabic simple">
<li><p>the transmissivity <span class="math notranslate nohighlight">\(\hat{t}\)</span> (note that I”ve changed the Stull’s notation to
use <em>t</em> instead of <span class="math notranslate nohighlight">\(\tau\)</span>)</p></li>
<li><p>the emissivity <em>e</em></p></li>
</ol>
<p>How does this equation relate to Beer’s law, and how would we use it to calculate <span class="math notranslate nohighlight">\(L_\lambda\)</span> reaching a satellite for a particular set of surface/atmosphere conditions?</p>
<p>Where does <a class="reference internal" href="#equation-stull1">()</a> come from?  To derive this from the Beer’s law we need to include the fact that the atmosphere is emitting as well as absorbing radiation.</p>
<p>Our previous form of Beer’s law looks like this <a class="reference external" href="../week2/beers_law.html#diffbeers">(see beers)</a>:</p>
<div class="math notranslate nohighlight" id="equation-diffbeers">
<span class="eqno">()<a class="headerlink" href="#equation-diffbeers" title="Permalink to this equation">¶</a></span>\[\frac{dE^\prime}{E^\prime} = \frac{dL^\prime \Delta \omega}{L^\prime \Delta \omega} = d \ln L^\prime = -d (n\,b\,s) = -d \tau^\prime\]</div>
<p>where <span class="math notranslate nohighlight">\(s\ (m)\)</span> is the distance travelled (the path length),
<span class="math notranslate nohighlight">\(n\ (\#/m^3)\)</span> is the number denstiy of reflecting/absorbing
particles and <span class="math notranslate nohighlight">\(b\ (m^2)\)</span> is the extinction cross section due to
absorption only.</p>
<p>Integrating from the surface where <span class="math notranslate nohighlight">\(\tau^\prime=0,\ L^\prime=L_{skin}\)</span> to
a vertical height <em>z</em> where <span class="math notranslate nohighlight">\(\tau^\prime = \tau,L^\prime = L\)</span> gives:</p>
<div class="math notranslate nohighlight">
\[\int_{L_{skin}}^L  d \ln L^\prime = -\int_0^\tau d\tau^\prime\]</div>
<div class="math notranslate nohighlight">
\[\ln \left ( \frac{L}{L_{skin}} \right ) = - \tau\]</div>
<p>Doing the integral</p>
<div class="math notranslate nohighlight">
\[L = L_{skin} \exp (-\tau)  = L_{skin} \hat{t}_{tot} = B_\lambda(T_{skin}) \hat{t}_{tot}\]</div>
<p>where the total transmissivity is:</p>
<div class="math notranslate nohighlight">
\[\hat{t}_{tot} = \exp (-\tau)\]</div>
<p>This is the surface term in <a class="reference internal" href="#equation-stull1">()</a> above, assuming that the surface is radiating like a blackbody at temperature <span class="math notranslate nohighlight">\(T_{skin}\)</span>.</p>
</div>
<div class="section" id="kirchoff-s-law">
<h2>Kirchoff’s Law<a class="headerlink" href="#kirchoff-s-law" title="Permalink to this headline">¶</a></h2>
<p>The atmosphere isn’t a blackbody, because it’s absorptivity <span class="math notranslate nohighlight">\(a = 1 - \hat{t}\)</span> (no reflection) is not equal to 1 at most wavelengths.  Stull p. 41 defines the emissivity <em>e</em> as the fraction of the actual emitted radiance of an object/layer over the radiance a blackbody would emit at the same temperature:</p>
<div class="math notranslate nohighlight">
\[e_\lambda = L_{emitted}/B_\lambda(T)\]</div>
<p>He also says that</p>
<div class="math notranslate nohighlight">
\[a_\lambda = e_\lambda\]</div>
<p>i.e. “good absorbers are good emitters” or Kirchoff’s Law.</p>
<p>To see why this has to be true, consider <code class="xref std std-numref docutils literal notranslate"><span class="pre">kirchoff</span></code>, where a blackbody (surface A) is facing a surface B at the same temperature, with absorptivity and emissivity that violate Kirchoff’s law (there is a vacuum between the two plates).  Neither surface is transmitting, so surface B is absorbing <span class="math notranslate nohighlight">\(0.6 B_\lambda(T)\)</span> emitted by surface A and emitting <span class="math notranslate nohighlight">\(0.7 B_\lambda(T)\)</span> on its own.  Because it is emitting more than it’s absorbed, it has to be cooling, but according to the second law of thermodynamics,  objects at the same temperature can’t spontaneously change their temperature without doing work.   So we know that <span class="math notranslate nohighlight">\(a_\lambda = e_\lambda\)</span>.</p>
<div class="figure align-default" id="kirchoff">
<a class="reference internal image-reference" href="courseware/figures/kirchoff.png"><img alt="courseware/figures/kirchoff.png" src="courseware/figures/kirchoff.png" /></a>
<p class="caption"><span class="caption-text">Demonstration of Kirchoff’s law</span><a class="headerlink" href="#kirchoff" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="adding-emission-to-beer-s-law">
<h2>Adding emission to Beer’s law<a class="headerlink" href="#adding-emission-to-beer-s-law" title="Permalink to this headline">¶</a></h2>
<p>Now include the relationship between <span class="math notranslate nohighlight">\(\hat{t}\)</span>, <span class="math notranslate nohighlight">\(\tau\)</span>, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(e\)</span>:</p>
<div class="math notranslate nohighlight">
\[\hat{t}_\lambda = \frac{L_{\lambda}}{L_{\lambda 0}} = \exp ( - \tau_\lambda)\]</div>
<p>Differentiate this:</p>
<div class="math notranslate nohighlight" id="equation-diffthat">
<span class="eqno">()<a class="headerlink" href="#equation-diffthat" title="Permalink to this equation">¶</a></span>\[ d \hat{t}_\lambda = d \exp(-\tau_\lambda) = - \exp(-\tau_\lambda)\, d\tau_\lambda = -d\tau_\lambda\]</div>
<p>where we have used the fact that for a thin layer we are expanding about <span class="math notranslate nohighlight">\(\tau = 0\)</span>.</p>
<p>Now what about the absorption?  Repeat this procedure:</p>
<div class="math notranslate nohighlight">
\[a_\lambda = (1 - \hat{t}_\lambda)\]</div>
<p>Kirchoff says:</p>
<div class="math notranslate nohighlight">
\[e_\lambda = a_\lambda = (1 - \hat{t}_\lambda)\]</div>
<p>So we can use <a class="reference internal" href="#equation-diffthat">()</a> to get</p>
<div class="math notranslate nohighlight">
\[de_\lambda = da_\lambda = d(1 - \hat{t}_\lambda) = -d\hat{t}_\lambda  = d\tau_\lambda\]</div>
<p>Suppose the layer has constant temperature <span class="math notranslate nohighlight">\(T_{layer}\)</span>, then as usual</p>
<div class="math notranslate nohighlight">
\[L_{emission} = e_\lambda B_{\lambda} (T_{layer})\]</div>
<p>How do we combine this emission with Beer’s law to get the total radiance coming through the top of the layer?</p>
<p>The figure below shows the radiance emitted from the surface and from the thin layer, with their combine contribution to the top of the atmosphere radiance at optical depth <span class="math notranslate nohighlight">\(\tau_T\)</span>:</p>
<div class="figure align-default" id="schwartzchild">
<a class="reference internal image-reference" href="courseware/figures/schwartzchild.png"><img alt="courseware/figures/schwartzchild.png" src="courseware/figures/schwartzchild.png" /></a>
<p class="caption"><span class="caption-text">Radiance from an isolated layer and the surface</span><a class="headerlink" href="#schwartzchild" title="Permalink to this image">¶</a></p>
</div>
<p>Before we integrate the entire atmosphere (with temperature changing with height) let’s just integrate the radiance across a layer that is thin enough so we can assume roughly constant temperature.</p>
<ol class="arabic">
<li><p>We know the emission from an infinitesimally thin layer:</p>
<div class="math notranslate nohighlight" id="equation-dlemit">
<span class="eqno">()<a class="headerlink" href="#equation-dlemit" title="Permalink to this equation">¶</a></span>\[dL_{emission} = B_{\lambda} (T_{layer}) de_\lambda = B_{\lambda} (T_{layer}) d\tau_\lambda\]</div>
</li>
<li><p>Add the gain from <span class="math notranslate nohighlight">\(dL_{emission}\)</span> to the loss from <span class="math notranslate nohighlight">\(dL_{absorption}\)</span> to get
the <strong>Schwartzchild equation</strong> without scattering:</p>
<div class="math notranslate nohighlight" id="equation-schwart1">
<span class="eqno">()<a class="headerlink" href="#equation-schwart1" title="Permalink to this equation">¶</a></span>\[dL_{\lambda,absorption} + dL_{\lambda,emission}  = -L_\lambda\, d\tau_\lambda + B_\lambda (T_{layer})\, d\tau_\lambda\]</div>
</li>
<li><p>We can rewrite <a class="reference internal" href="#equation-schwart1">()</a> as:</p>
<div class="math notranslate nohighlight" id="equation-schwart2">
<span class="eqno">()<a class="headerlink" href="#equation-schwart2" title="Permalink to this equation">¶</a></span>\[\frac{dL_\lambda}{d\tau_\lambda} = -L_\lambda + B_\lambda (T_{layer})\]</div>
</li>
<li><p>In class I used change of variables to derived the following: if the temperature <span class="math notranslate nohighlight">\(T_{layer}\)</span>  (and hence <span class="math notranslate nohighlight">\(B_\lambda(T_{layer})\)</span>) is constant with height and the radiance arriving at the base of the layer is <span class="math notranslate nohighlight">\(L_{\lambda 0} = B_{\lambda} T_{skin}\)</span> for a black surface with <span class="math notranslate nohighlight">\(e_\lambda = 1\)</span>, then the total radiance exiting the top of the layer is <span class="math notranslate nohighlight">\(L_{\lambda}\)</span> where:</p>
<div class="math notranslate nohighlight" id="equation-consttb">
<span class="eqno">()<a class="headerlink" href="#equation-consttb" title="Permalink to this equation">¶</a></span>\[      \int_{L_{\lambda 0}}^{L_\lambda} \frac{dL^\prime_\lambda}{L^\prime_\lambda -
      B_\lambda} = - \int_{0}^{\tau_{T}} d\tau^\prime\]</div>
<p>Where the limits of integration run from just above the black surface (where the radiance from
the surface is <span class="math notranslate nohighlight">\(L_{\lambda 0}\)</span>) and <span class="math notranslate nohighlight">\(\tau=0\)</span> to the top of the layer, (where the radiance is <span class="math notranslate nohighlight">\(L_\lambda\)</span>) and the optical thickness is <span class="math notranslate nohighlight">\(\tau_{\lambda T}\)</span>.</p>
<p>To integrate this, make the change of variables:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
U^\prime &amp;= L^\prime_\lambda - B_\lambda \\
dU^\prime &amp;= dL^\prime_\lambda\\
\frac{dL^\prime_\lambda}{L^\prime_\lambda -
     B_\lambda} &amp;= \frac{dU^\prime}{U^\prime} = d\ln U^\prime
\end{align}\end{split}\]</div>
<p>where I have made use of the fact that <span class="math notranslate nohighlight">\(dB_\lambda = 0\)</span> since the temperature is constant.</p>
<p>This means that we can now solve this by integrating a perfect differential:</p>
<div class="math notranslate nohighlight" id="equation-consttc">
<span class="eqno">()<a class="headerlink" href="#equation-consttc" title="Permalink to this equation">¶</a></span>\[\int_{U_0}^U d\ln U^\prime = \ln \left (\frac{U}{U_0} \right ) =  \ln \left (\frac{L_\lambda - B_\lambda}{L_{\lambda 0} - B_\lambda}
      \right ) = - \tau_{\lambda T}\]</div>
<p>Taking the <span class="math notranslate nohighlight">\(\exp\)</span> of both sides:</p>
<div class="math notranslate nohighlight" id="equation-consttd">
<span class="eqno">()<a class="headerlink" href="#equation-consttd" title="Permalink to this equation">¶</a></span>\[L_\lambda - B_\lambda = (L_{\lambda 0} - B_\lambda) \exp (-\tau_{\lambda T})\]</div>
<p>or rearranging and recognizing that the transmittance is <span class="math notranslate nohighlight">\(\hat{t_\lambda} = \exp(-\tau_{\lambda T} )\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-rad-constant">
<span class="eqno">()<a class="headerlink" href="#equation-rad-constant" title="Permalink to this equation">¶</a></span>\[ L_\lambda = L_{\lambda 0} \exp( -\tau_{\lambda T}  ) + B_\lambda (T_{layer})(1- \exp( -\tau_{\lambda T} ))\]</div>
<div class="math notranslate nohighlight">
\[L_\lambda = L_{\lambda 0} \hat{t}_{\lambda}  + B_\lambda (T_{layer})(1- \hat{t}_{\lambda})\]</div>
<div class="math notranslate nohighlight">
\[L_\lambda = L_{\lambda 0}  \hat{t}_{\lambda} + B_\lambda (T_{layer})a_\lambda\]</div>
</li>
<li><p>so bringing in Kirchoff’s law, the radiance exiting the top of the isothermal layer of thickness <span class="math notranslate nohighlight">\(\Delta \tau\)</span> is:</p>
<div class="math notranslate nohighlight">
\[L_\lambda = L_{\lambda 0}  \hat{t}_{\lambda} + e_\lambda B_\lambda\]</div>
</li>
</ol>
</div>
<div class="section" id="temperature-changing-with-height">
<span id="temp-height"></span><h2>Temperature changing with height<a class="headerlink" href="#temperature-changing-with-height" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-to-stull-8-3">
<h3>Getting to Stull 8.3<a class="headerlink" href="#getting-to-stull-8-3" title="Permalink to this headline">¶</a></h3>
<p>To get Stull’s eq. 8.3 (our <a class="reference internal" href="#equation-stull1">()</a>),  we need integrate <a class="reference internal" href="#equation-schwart2">()</a> when temperature and therefor  <span class="math notranslate nohighlight">\(B_\lambda(T)\)</span>  is changing with height.</p>
<ul class="simple">
<li><p>Here’s the Schwartzchild equation again:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-schwartza">
<span class="eqno">()<a class="headerlink" href="#equation-schwartza" title="Permalink to this equation">¶</a></span>\[ \frac{dL_\lambda}{d\tau_\lambda}= - L_{\lambda} + B_\lambda\]</div>
<ul class="simple">
<li><p>Now with <span class="math notranslate nohighlight">\(T\)</span> changing with height, we need to use an
integrating factor to solve this.  Essentially this means  multiplying both sides
by <span class="math notranslate nohighlight">\(exp(\tau)\)</span> so that we’re in the position to integrate a perfect differential:</p></li>
<li><p>Specifically, look at how the chain rule works for the product <span class="math notranslate nohighlight">\(L\exp(\tau)\)</span>   :</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-chain">
<span class="eqno">()<a class="headerlink" href="#equation-chain" title="Permalink to this equation">¶</a></span>\[d(L\exp(\tau))=\exp(\tau)dL + L\exp(\tau)d\tau\]</div>
<ul class="simple">
<li><p>Now multiply both sides of <a class="reference internal" href="#equation-schwartza">()</a> by  <span class="math notranslate nohighlight">\(exp(\tau)\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-integ1">
<span class="eqno">()<a class="headerlink" href="#equation-integ1" title="Permalink to this equation">¶</a></span>\[\exp(\tau) dL_\lambda +
L_\lambda \exp(\tau)\,d\tau=\exp(\tau)B_\lambda(T) \,d\tau\]</div>
<ul>
<li><p>Next use use the chain rule in reverse to combine the two terms on the
left, and integrate:</p>
<div class="math notranslate nohighlight">
\[d\left( L_\lambda\exp(\tau)\right )=\exp(\tau)B_\lambda d\tau\]</div>
<div class="math notranslate nohighlight" id="equation-chain2">
<span class="eqno">()<a class="headerlink" href="#equation-chain2" title="Permalink to this equation">¶</a></span>\[ \int_0^{\tau}d(L^\prime_\lambda\exp(\tau^\prime))=\int_0^{\tau}
 \exp(\tau^\prime)B^\prime_\lambda d\tau^\prime\]</div>
</li>
<li><p>Impose the boundary condition that at <span class="math notranslate nohighlight">\(\tau^\prime=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
 L^\prime_\lambda=B_\lambda(T_{skin})\\
 \hat{t}_\lambda=\exp(0)=1
\end{gathered}\end{split}\]</div>
</li>
<li><p>Which means that when we integrate <a class="reference internal" href="#equation-chain2">()</a> we get:</p>
<div class="math notranslate nohighlight">
\[L_\lambda\exp(\tau) - B_\lambda(T_{skin}) = \int_0^{\tau} \exp(\tau^\prime)B_\lambda(T^\prime) d\tau^\prime\nonumber\]</div>
</li>
<li><p>Dividing through by <span class="math notranslate nohighlight">\(\exp(\tau)\)</span> we get:</p>
<div class="math notranslate nohighlight" id="equation-calc1">
<span class="eqno">()<a class="headerlink" href="#equation-calc1" title="Permalink to this equation">¶</a></span>\[L_\lambda(\tau)= B_\lambda(T_{skin})( \exp(-\tau) +    \int_0^{\tau} \exp\left(  - (\tau -\tau^\prime) \right )
B_\lambda(T)\, d\tau^\prime\]</div>
</li>
<li><p>Equation <a class="reference internal" href="#equation-calc1">()</a> works for any height in the atmosphere. For the particular case at the top of the atmosphere where <span class="math notranslate nohighlight">\(\tau = \tau_{\lambda T}\)</span>  we have</p>
<div class="math notranslate nohighlight" id="equation-calc2">
<span class="eqno">()<a class="headerlink" href="#equation-calc2" title="Permalink to this equation">¶</a></span>\[L_\lambda(\tau_{\lambda T})= B_\lambda(T_{skin})( \exp(-\tau_{\lambda T}) +    \int_0^{\tau} \exp\left(  - (\tau_{\lambda T} -\tau^\prime) \right )
B_\lambda(T)\, d\tau^\prime\]</div>
</li>
<li><p><strong>Compare</strong> <a class="reference internal" href="#equation-calc2">()</a> <strong>to Stull 8.3, which is:</strong></p>
<div class="math notranslate nohighlight" id="equation-stull2">
<span class="eqno">()<a class="headerlink" href="#equation-stull2" title="Permalink to this equation">¶</a></span>\[        \begin{gathered}
        L_\lambda = B_\lambda(T_{skin} ) \hat{t}_{tot} + \sum_{j=1}^n e_\lambda B_\lambda(T_j) \hat{t}_{\lambda,j}
        \end{gathered}\]</div>
<p>We can connect <a class="reference internal" href="#equation-stull2">()</a> and <a class="reference internal" href="#equation-calc2">()</a> if we recognize that</p>
<div class="math notranslate nohighlight">
\[\hat{t}_{\lambda,j} =  \exp\left( -(\tau_{\lambda T} -\tau_j) \right )\]</div>
<p>i.e. <span class="math notranslate nohighlight">\(\hat{t}\)</span> is the transmission from layer j to the top of the atmosphere and also that
the layers are thin enough so that we can make the approximation that:</p>
<div class="math notranslate nohighlight">
\[e_\lambda = de_\lambda = d\tau^\prime\]</div>
</li>
</ul>
</div>
<div class="section" id="getting-to-stull-8-4">
<span id="weightfuns"></span><h3>Getting to Stull 8.4<a class="headerlink" href="#getting-to-stull-8-4" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Equation 8.4 on p. 225 says:</p>
<div class="math notranslate nohighlight" id="equation-stull3">
<span class="eqno">()<a class="headerlink" href="#equation-stull3" title="Permalink to this equation">¶</a></span>\[   \begin{gathered}
     L_\lambda = B_\lambda(T_{skin}) \hat{t}_{\lambda,tot} + \sum_{j=1}^n
     B_\lambda(T_j) \Delta \hat{t}_{\lambda,j}
   \end{gathered}\]</div>
</li>
<li><p>What happened to <span class="math notranslate nohighlight">\(e_\lambda(z_j)\)</span> and <span class="math notranslate nohighlight">\(\hat{t}_{\lambda,j}\)</span> from <a class="reference internal" href="#equation-stull2">()</a>?  To see why this works, go back to the exact solution <a class="reference internal" href="#equation-calc2">()</a> and  use the definition <span class="math notranslate nohighlight">\(\hat{t} =   \exp\left( -(\tau_{\lambda T} -\tau^\prime) \right )\)</span></p>
<div class="math notranslate nohighlight" id="equation-calc3">
<span class="eqno">()<a class="headerlink" href="#equation-calc3" title="Permalink to this equation">¶</a></span>\[     L_\lambda(\tau_{\lambda T})= B_\lambda(T_{skin})( \exp(-\tau_{\lambda T}) +    \int_0^{\tau} B(T)\, \hat{t} \, d\tau^\prime\]</div>
<p>Now recognize that you can do the following differential:</p>
<div class="math notranslate nohighlight" id="equation-transdiff">
<span class="eqno">()<a class="headerlink" href="#equation-transdiff" title="Permalink to this equation">¶</a></span>\[      d\hat{t} = \frac{ d\hat{t}_{j} }{d\tau^\prime}\, d \tau^\prime  =
     \exp\left( -(\tau_{\lambda T} -\tau^\prime)\right ) d \tau^\prime = \hat{t}\, d\tau^\prime\]</div>
<p>So insert <a class="reference internal" href="#equation-transdiff">()</a> into <a class="reference internal" href="#equation-calc3">()</a> to get</p>
<div class="math notranslate nohighlight" id="equation-calc4">
<span class="eqno">()<a class="headerlink" href="#equation-calc4" title="Permalink to this equation">¶</a></span>\[      L_\lambda(\tau_{\lambda T})= B_\lambda(T_{skin}) \exp(-\tau_{\lambda T}) +    \int_0^{\tau_{\lambda T}} B_\lambda(T)\, d\hat{t}\]</div>
<p>Which is just the calculus version of <a class="reference internal" href="#equation-stull3">()</a>.  The <span class="math notranslate nohighlight">\(\Delta \hat{t}\)</span> term in <a class="reference internal" href="#equation-stull3">()</a> is called the “weighting function”, defined by</p>
<div class="math notranslate nohighlight" id="equation-weights">
<span class="eqno">()<a class="headerlink" href="#equation-weights" title="Permalink to this equation">¶</a></span>\[        \Delta \hat{t} = \exp\left( -(\tau_{\lambda T} -\tau^\prime) \right )  \Delta \tau^\prime\]</div>
<ul class="simple">
<li><p><strong>Question</strong>: notice that as we make <span class="math notranslate nohighlight">\(\Delta \tau^\prime\)</span> thicker in <a class="reference internal" href="#equation-weights">()</a> the transmissivity <span class="math notranslate nohighlight">\(\Delta \hat{t}\)</span> becomes larger – why does this make sense?</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="why-do-we-care">
<h2>Why do we care?<a class="headerlink" href="#why-do-we-care" title="Permalink to this headline">¶</a></h2>
<p>We care because if we know  <em>T(z)</em> and <span class="math notranslate nohighlight">\(\tau(z)\)</span> as a function of height we can use  <a class="reference internal" href="#equation-weights">()</a> to calculate the weighting function <span class="math notranslate nohighlight">\(\Delta \hat{t}_\lambda\)</span> and find the radiance <span class="math notranslate nohighlight">\(L_\lambda\)</span> at the satellite using <a class="reference internal" href="#equation-stull3">()</a>.  Alternatively, if we measure <span class="math notranslate nohighlight">\(L_\lambda\)</span> from satellites we can say something about <em>T(z)</em> and <span class="math notranslate nohighlight">\(\tau(z)\)</span></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./courseware"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Brian Rose<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>